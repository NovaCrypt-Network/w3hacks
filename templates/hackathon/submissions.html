{% extends 'hackathon/base.html' %}
{% load static %}
{% block head %}
  <link rel="stylesheet" href="{% static 'hackathon/submissions.css' %}">
{% endblock %}
{% block body %}
  <div class="heading-banner">
    <div class="container">
      <h1>Submissions</h1>
      <p>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
      </p>
    </div>
  </div>
  <div class="container">
    {% if user_submission %}
      <div class="user-submission">
        <h3>My Submission</h3>
        <div class="submissions">
          <div class="submission">
            <h3>{{ user_submission.title }}</h3>
            <div class="submission-btns">
              <img class="submission-btn" src="{% static 'img/github.png' %}" alt="">
              <img class="submission-btn" src="{% static 'img/out.png' %}" alt="">
              <button onclick="deleteUserSubmission()">&times;</button>
            </div>
            <p>
              {{ user_submission.description }}
            </p>
          </div>
        </div>
      </div>
    {% endif %}

    {% if submissions %}
      <h3>Submissions</h3>
      <div class="submissions">
        {% for submission in submissions %}
          <div class="submission">
            <h3>{{ submission.title }}</h3>
            <div class="submission-btns">
              <img class="submission-btn" src="{% static 'img/github.png' %}" alt="">
              <img class="submission-btn" src="{% static 'img/out.png' %}" alt="">
            </div>
            <p>
              {{ submission.description }}
            </p>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <small>No other submissions yet!</small>
    {% endif %}
  </div>

  <script>
    function deleteUserSubmission() {
      alertify.confirm("Are you sure you want to delete your submission?",
        function(){
          // Send off alert
          alertify.success('Your submission has successfully been deleted.');

          // Hide the submission
          document.querySelector(".user-submission").style.display = "none";

          // Delete the submission asynchronously
          fetch("/{{ hackathon.id }}/submissions/?project_id={{ user_submission.id }}", {
            method: "GET"
          });
        }
      );
    }
  </script>
{% endblock %}
